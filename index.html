function checkVideoInList(url) {
    const item = document.querySelector('[data-url="' + url + '"]');
    if (!item) return;

    const indicator = item.querySelector('.video-item-indicator');
    const status = item.querySelector('.video-item-status');

    // Set checking state
    indicator.className = 'video-item-indicator checking';
    status.textContent = 'Checking...';
    status.className = 'video-item-status';

    let resolved = false;
    const PROXY_URL = 'https://corsproxy.io/?'; // CORS solution
    const xhr = new XMLHttpRequest();
    
    xhr.timeout = 5000; // 5-second timeout
    
    xhr.onload = function() {
        if (!resolved) {
            resolved = true;
            if (xhr.status >= 200 && xhr.status < 300) {
                setOnline(indicator, status, 'Online');
            } else {
                setOffline(indicator, status, 'Offline');
            }
        }
    };
    
    xhr.onerror = xhr.ontimeout = function() {
        if (!resolved) {
            resolved = true;
            setOffline(indicator, status, 'Error or Timeout');
        }
    };
    
    try {
        xhr.open('HEAD', PROXY_URL + url, true);
        xhr.send();
    } catch (e) {
        console.error('Exception during XHR:', e);
        setOffline(indicator, status, 'Request error');
    }

    function setOnline(indicator, status, message) {
        indicator.className = 'video-item-indicator online';
        status.textContent = message;
        status.className = 'video-item-status online';
    }

    function setOffline(indicator, status, message) {
        indicator.className = 'video-item-indicator offline';
        status.textContent = message;
        status.className = 'video-item-status offline';
    }
}
